<%- include('../partials/header', { title: 'Nova Incidència' }) %>

    <div class="title-box">
        <h1>REGISTRAR NOVA INCIDÈNCIA</h1>
    </div>

    <!-- Utilitzem les classes i estructura del teu form_incidencia.html -->
    <!-- El formulari apunta a la ruta POST /incidenciass/create -->
    <form action="/incidencias/create" method="POST" class="incidencias-form" style="width: 80%; max-width: 700px; background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border: 1px solid #ddd;">

        <!-- Camp per al Títol -->
        <div class="form-group">
            <label for="incidencias_title">Títol breu:</label>
            <input type="text" id="incidencias_title" name="title" required placeholder="Ex: Projector aula B15 no funciona">
        </div>

        <!-- Camp per a la Descripció -->
        <div class="form-group">
            <label for="incidencias_desc">Descripció detallada:</label>
            <textarea id="incidencias_desc" name="description" rows="6" required placeholder="Descriu el problema: què passa, on exactament, des de quan..."></textarea>
        </div>


        <!-- Camp per seleccionar a qui s'assigna (Opcional) -->
         <div class="form-group">
            <label for="assignedUser">Assignat a:</label>
            <select id="assignedUser" name="assignedUserId">
                <option value="">-- No Assignat --</option> <!-- Valor buit per no assignar -->
                <% users.forEach(user => { %>
                     <% if (user.role === 'technician' || user.role === 'admin') { %> <!-- Només tècnics/admins? -->
                        <option value="<%= user.id %>"><%= user.firstName %> <%= user.lastName %> (<%= user.username %>)</option>
                     <% } %>
                <% }); %>
            </select>
        </div>

        <!-- Botons d'acció -->
        <div class="form-group">
            <button type="submit">Crear Incidència</button>
            <button type="reset">Netejar</button>
        </div>

    </form>

<%- include('../partials/footer') %>