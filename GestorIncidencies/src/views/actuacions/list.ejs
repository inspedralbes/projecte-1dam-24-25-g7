<%- include('../partials/header', { title: 'Llista d\'Actuacions' }) %>

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="mb-0">LLISTA D'ACTUACIONS</h1>
        <a href="/actuacions/new" class="btn btn-success">Nova Actuació</a>
    </div>

    <% if (typeof errorMessage !== 'undefined' && errorMessage) { %>
        <div class="alert alert-danger" role="alert">
            <%= errorMessage %>
        </div>
    <% } %>

    <div class="card shadow-sm">
        <div class="card-body">
            <% if (typeof actuacions !== 'undefined' && actuacions.length > 0) { %>
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-light">
                            <tr>
                                <th scope="col">ID Act.</th>
                                <th scope="col">Descripció Actuació</th>
                                <th scope="col">Temps (min)</th>
                                <th scope="col">Visible</th>
                                <th scope="col">Incidència (ID)</th>
                                <th scope="col">Desc. Incidència</th>
                                <th scope="col">Tècnic Actuació</th>
                                <th scope="col">Accions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% actuacions.forEach(actuacio => { %>
                                <tr>
                                    <td><%= actuacio.id %></td>
                                    <td><%= actuacio.descripcio %></td>
                                    <td><%= actuacio.temps || 'N/A' %></td>
                                    <td><%= actuacio.visible ? 'Sí' : 'No' %></td>
                                    <td>
                                        <% if (actuacio.Incidencia) { %>
                                            <a href="/incidencies/<%= actuacio.Incidencia.id %>"><%= actuacio.Incidencia.id %></a>
                                        <% } else { %>
                                            N/A
                                        <% } %>
                                    </td>
                                    <td><%= actuacio.Incidencia ? actuacio.Incidencia.descripcio : 'N/A' %></td>
                                    <td><%= actuacio.Tecnic ? actuacio.Tecnic.nom : 'No assignat' %></td>
                                    <td>
                                        <a href="/actuacions/<%= actuacio.id %>/edit" class="btn btn-warning btn-sm">Editar</a>
                                        <!-- Aquí podria anar un formulari per ELIMINAR actuacions si ho implementes -->
                                    </td>
                                </tr>
                            <% }); %>
                        </tbody>
                    </table>
                </div>
            <% } else { %>
                <p class="text-center">No hi ha actuacions per mostrar.</p>
            <% } %>
        </div>
    </div>

<%- include('../partials/footer') %>